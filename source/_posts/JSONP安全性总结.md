---
title: JSONP安全性总结
date: 2017-03-31 19:34:18
tags: 
- JSONP
categories: 
- 前端
---

<!-- more -->

## Callback参数注入

可以利用Callback参数向页面注入并执行js脚本，从而获取用户数据等信息。

防御方法：参考[XSS攻击](./XSS攻击.md)

- 白名单字符过滤

    也可以采用黑名单，但是JS中恶意字符的变形十分多，需要枚举所有非法字符，可能存在疏漏。

- 严格控制Callback格式。

    对于Callback参数作严整的格式检查，或强制约定指定格式。
    
    该方法基本可以彻底解决安全问题，但同样是对调用端不是完全透明，使用者需要额外去知晓相关限制和约定，可能会造成不必要的沟通成本。
   
- 敏感资源保护起来

## DOM注入

返回包体添加`header`头部，强制指定`MIME`类型，避免按`HTML`方式解析，防止XSS漏洞。

## 资源访问

防止JSONP资源被滥用。

防止非法站点利用JSONP获取系统信息。

解决防范：

- 来源`refer`白名单匹配

验证是授权站点才可以访问`JSONP`资源。

- `cookieToken`机制来限制

服务器必须拿到`cookie`中存储的`toke`n信息，才允许访问`JSONP`资源。